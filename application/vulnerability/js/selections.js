// function to detect Internet Explorer

function isInternetExplorer() {
	return window.navigator.userAgent.match(/(MSIE|Trident)/);
}

function showBrowserAlert() {
	if(isInternetExplorer()){
       // Do not show initial form
       $("#form").hide();
       $("#browserAlert").show();
    } else {
    	console.log('All good');
    }
}

// Initialize the dropdowns as select2 dropdowns via jquery plugin
$(document).ready(function() {
    $('.single-select').select2();
    const startKpiVal = 'Georgia';
    $('#kpiOne').text(kpiSelect[startKpiVal].Cases);
    $('#kpiTwo').text(kpiSelect[startKpiVal].Deaths);
    $('#kpiThree').text(kpiSelect[startKpiVal].CasesPer1K);
    $('#kpiFour').text(kpiSelect[startKpiVal].Recent_Cases);
});

//populate the geography dropdown based on the level that's been chosen in the level dropdown
$("#level-select").change(function() {
	//remove any existing option from the geography select
	$("#geo-select option").remove();
	// get the value of item selected in level-select
	var _val = this.options[this.selectedIndex].value;
	// go through the geographies object, find the matching value, and create an option for each
	for (var i in geographies[_val]) {
		// create option target
		var op = document.createElement('option');
		// set option value value
		op.value = geographies[_val][i];
		// set the display label
		op.text = geographies[_val][i];
		// append it to geography dropdown
		$('#geo-select').append(op);
	}
});

// check for the selection change
$("#fill-select").change(function() {
	var val = $(this).val();
	var label = selectObj.fills[val].label;
	var fill = selectObj.fills[val].fill;
	var minFill = selectObj.fills[val].min;
	var maxFill = selectObj.fills[val].max;

	$('#minFill').text(minFill);
	$('#maxFill').text(maxFill);

	$(".key-subhead").contents().remove();
	$(".key-subhead").text(label);

	map.setPaintProperty('countyFill','fill-color',fill);

	if (val == 11) {
		$(".g-level-0").css("background-color","#e66101")
		$(".g-level-1").css("background-color","#fdb863")
		$(".g-level-2").css("background-color","#f7f7f7")
		$(".g-level-3").css("background-color","#b2abd2")
		$(".g-level-4").css("background-color","#5e3c99")
	} else {
		$(".g-level-0").css("background-color","#f2f0f7")
		$(".g-level-1").css("background-color","#cbc9e2")
		$(".g-level-2").css("background-color","#9e9ac8")
		$(".g-level-3").css("background-color","#756bb1")
		$(".g-level-4").css("background-color","#54278f")
	}

});

$("#point-select").change(function() {
	var val = $(this).val();
	var size = selectObj.points[val].circles;
	var minSize = selectObj.points[val].min;
	var maxSize = selectObj.points[val].max;
	$('#minSize').text(minSize);
	$('#maxSize').text(maxSize);

	map.setPaintProperty('points','circle-radius',size);
	map.setLayoutProperty('points','visibility','visible');

});


