mapboxgl.accessToken = 'pk.eyJ1IjoibW1haW56ZXIiLCJhIjoiY2s5N2EyZXZtMTRjMTNocDM1Y3l3YmQ2OSJ9.QHEDzX1oIKjn8C13KG3vQQ';


const map = new mapboxgl.Map({
	container: 'map',
	style: 'mapbox://styles/mmainzer/ck94bk9gi12jq1iqmhnzfh0dm?fresh=true',
	center: [-82.993, 32.723],
	zoom: 6.4,
	scrollZoom: true,
	doubleClickZoom: true,
	renderWorldCopies: false
});

// add necessary layers

map.on('load', function() {

	map.addSource('county-poly', {
		type: 'vector',
		url: 'mapbox://mmainzer.ck95njake1u0l2ko8bkdpsn17-2uthq?fresh=true'
	});

	map.addSource('county-points', {
		type: 'vector',
		url: 'mapbox://mmainzer.ck95o36v91dz12lo4awbp3gbv-90ft5?fresh=true'
	});

	map.addSource('hospitalPoints', {
		type: 'vector',
		url: 'mapbox://mmainzer.ck97opj7x2gfi2wo8v8585xtc-8do0y?fresh=true'
	});

	map.addLayer({
        'id':'countyFill',
        'type':'fill',
        'source':'county-poly',
        'layout': {
          'visibility':'visible',
        },
        'paint': {
          "fill-color": ["interpolate",
          					["linear"],
          					["get", "CCVI_Score"],
				          	0.19,"hsla(257, 30%, 95%, 0.8)",
				          	0.39,"hsla(245, 30%, 84%, 0.8)",
				          	0.59,"hsla(245, 29%, 69%, 0.8)",
				          	0.79,"hsla(249, 31%, 56%, 0.8)",
				          	0.99,"hsla(266, 57%, 36%, 0.8)"
						],
          "fill-opacity": 0.8,
          "fill-outline-color": "#fff"
        },
        'source-layer': 'countyData'
      }, 'road-label')


	map.addLayer({
		'id':'points',
		'type':'circle',
		'source':'county-points',
		'layout': {
			'visibility':'visible'
		},
		'paint': {
			'circle-color':"hsla(0, 0%, 15%, 0.25)",
			'circle-opacity':1,
			'circle-stroke-color':"#252525",
			'circle-stroke-width':1,
			'circle-radius':[
							  "interpolate",
							  ["linear"],
							  ["get", "Cases_1000_Norm"],
							  0,1,
							  9,5,
							  19,7,
							  29,9,
							  39,11,
							  49,13,
							  59,15,
							  69,17,
							  79,19,
							  89,21,
							  99,23
							]
		},
		'source-layer':'countyPoints'
	}, 'ga-main-places')

	map.addLayer({
		'id':'gaHospitals',
		'type':'circle',
		'source':'hospitalPoints',
		'layout': {
			'visibility':'none'
		},
		'filter': ["all",["match",["get","STATE"],["GA"],true,false]],
		'paint': {
			'circle-color':"hsla(0, 0%, 15%, 0.25)",
			'circle-opacity':1,
			'circle-stroke-color':"#252525",
			'circle-stroke-width':1,
			'circle-radius':[
							  "interpolate",
							  ["linear"],
							  ["get", "BEDS"],
							  2,5,
							  400,11,
							  797,17,
							  1195,23,
							  1592,29
							]
		},
		'source-layer':'features'
	}, 'ga-main-places')


});









